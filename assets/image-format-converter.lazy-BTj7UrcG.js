import{c as O,u as C,r as d,j as e,I as N,S as j,B as h,A as P,E as R,aj as E,s as S}from"./index-CDMCwmAa.js";import{f as V,i as w,U as k,a as q,b,I as v,D as T,B as U}from"./fromBlob-DXlqDMoK.js";import{F as m}from"./index-BlEDdh0L.js";import{R as r}from"./index-qgnk8yU2.js";import"./editorWorker-CSXiZMy3.js";import"./useForceUpdate-CgnDAtmw.js";import"./index-B30jWsqn.js";const D=async(c,o)=>new Promise(s=>{V(c,void 0,void 0,void 0,o).then(i=>{w(i).then(u=>{s({base64:u})})})}),_=O("/_image/image-format-converter")({component:G});function G(){const c=C(),[o]=m.useForm(),[s,i]=d.useState({file:null,format:"png"}),[u,p]=d.useState(""),[a,f]=d.useState(null);d.useEffect(()=>{const t={file:null,format:"png"};i(t),o.setFieldsValue(t),p(""),f(null)},[o]);const y=()=>{var x;if(!a||!s.file)return;let t="png";const n=(x=/^data:image\/\w+;/.exec(a.base64))==null?void 0:x[0];n&&(t=n.slice(11,-1));const l=document.createElement("a");l.href=a.base64;const g=s.file.name.split(".");g.pop(),l.download=`${g.join(".")}.${t}`,l.click()},B=async()=>{if(!s.file){c(E("Need to select an image"));return}const t=await D(s.file,s.format);f({base64:t.base64,format:s.format}),c(S())},I=async t=>{if(!t.file.originFileObj)return;const n=t.file.originFileObj,l=await w(n);p(l),i({...s,file:n})},F=t=>{i({...s,...t})};return e.jsx(N,{InputToolbar:e.jsx(j,{children:e.jsx(h,{type:"primary",icon:e.jsx(P,{}),size:"large",onClick:B,children:"Convert"})}),InputView:e.jsxs(m,{form:o,layout:"vertical",size:"large",requiredMark:"optional",initialValues:s,validateMessages:{required:"This field is required"},onValuesChange:F,children:[e.jsx(k,{name:"image",accept:"image/*",listType:"picture-card",showUploadList:!1,onChange:I,customRequest:()=>{},children:e.jsxs("button",{type:"button",children:[e.jsx(q,{}),e.jsx("div",{className:"mt-2",children:"Select image"})]})}),b(u)&&e.jsx("div",{className:"mt-8 border border-solid border-gray-300 leading-0",children:e.jsx(v,{src:u})}),e.jsx(m.Item,{label:"Convert to format",name:"format",rules:[{required:!0}],className:"mt-8",children:e.jsxs(r.Group,{children:[e.jsx(r.Button,{value:"jpeg",children:"JPG"}),e.jsx(r.Button,{value:"png",children:"PNG"}),e.jsx(r.Button,{value:"webp",children:"WEBP"}),e.jsx(r.Button,{value:"bmp",children:"BMP"}),e.jsx(r.Button,{value:"gif",children:"GIF"})]})})]}),OutputToolbar:a===null?e.jsx(e.Fragment,{}):e.jsx(j,{children:e.jsx(h,{icon:e.jsx(T,{}),onClick:y,children:"Download"})}),OutputView:a&&b(a.base64)?e.jsx("div",{className:"border border-solid border-gray-300 leading-0",children:e.jsx(U.Ribbon,{color:"green",text:`Format: ${a.format.toUpperCase()}`,children:e.jsx(v,{src:a.base64})})}):e.jsx("div",{className:"h-full min-h-[250px] flex items-center justify-center border border-solid border-gray-300",children:e.jsx(R,{})})})}export{_ as Route};
